!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){n(1),e.exports=n(11)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){v.default.storage.sync.get("legacy_enabled",function(e){e.legacy_enabled&&c()})}function i(e){u(),("install"===e.reason||e.previousVersion.match(/^1\./))&&f()}function a(e,t){e.hasOwnProperty("name")&&"showPopup"===e.name&&(e.message.tab_id=t.tab?t.tab.id:null,(0,p.default)(e.message))}function s(){u()}function u(){"undefined"!=typeof chrome&&v.default.storage.sync.get("legacy_enabled",function(e){var t=e.legacy_enabled?"":"/views/popup.html";chrome.browserAction.setPopup({popup:t})})}function c(){chrome.tabs.executeScript(null,{code:"(function(){var s=document.createElement('script');s.setAttribute('type','text/javascript');s.setAttribute('charset','UTF-8');s.setAttribute('src','"+g+"/js/bookmarklet.min.js');document.documentElement.appendChild(s);})()"})}function d(){var e=safari.extension.settings.stored_version,t=safari.extension.displayVersion+"."+safari.extension.bundleVersion;"0"===e?(safari.extension.settings.stored_version=t,f()):t!==e&&(safari.extension.settings.stored_version=t)}function f(){v.default.tabs.create({url:"https://www.dropmark.com/extension/welcome"})}var l=n(2),p=o(l),m=n(3),v=o(m),g="https://app.dropmark.com";"undefined"!=typeof chrome?(chrome.browserAction.onClicked.addListener(r),v.default.runtime.addMessageListener(a),chrome.runtime.onStartup&&chrome.runtime.onStartup.addListener(s),chrome.runtime.onInstalled&&chrome.runtime.onInstalled.addListener(i)):d()},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){u=window.setInterval(function(){chrome.runtime.sendMessage(null,{context_data:e},null,function(e){e&&window.clearInterval(u)})},200)}function i(e){return"undefined"!=typeof chrome&&"undefined"==typeof chrome.windows||"undefined"!=typeof safari?s.default.runtime.sendMessage({name:"showPopup",message:e}):void chrome.windows.getCurrent(function(t){var n=0,o=0,i=510,a=410;n=t.left/2,o=t.top/2;var s=Math.round(screen.width/2-i/2-n),u=Math.round(screen.height/2-a/2-o),c=chrome.extension.getURL("views/popup.html#context");chrome.windows.create({url:c,type:"popup",height:a,width:i,top:u,left:s},function(t){r(e)})})}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),s=o(a),u=void 0;t.default=i},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=o(r),a=n(5),s=o(a),u=n(6),c=o(u),d=n(10),f=o(d),l={popover:i.default,runtime:s.default,storage:c.default,tabs:f.default};t.default=l},function(e,t){"use strict";function n(){return"undefined"!=typeof safari?safari.extension.popovers[0].hide():window.close()}Object.defineProperty(t,"__esModule",{value:!0});var o={close:n};t.default=o},function(e,t){"use strict";function n(e){if("undefined"!=typeof safari){var t=safari.application?safari.application:safari.self;return t.addEventListener("message",e,!1)}return chrome.runtime.onMessage.addListener(e)}function o(e){if("undefined"!=typeof safari){var t=safari.application?safari.application:safari.self;return t.removeEventListener("message",e,!1)}if("function"==typeof chrome.runtime.onMessage.removeListener)return chrome.runtime.onMessage.removeListener(e)}function r(e){if("undefined"!=typeof safari){var t=void 0;return t=safari.application?safari.application.activeBrowserWindow.activeTab.page:safari.self.tab,t.dispatchMessage(e.name,e)}return chrome.runtime.sendMessage(null,e,function(){})}Object.defineProperty(t,"__esModule",{value:!0});var i={addMessageListener:n,removeMessageListener:o,sendMessage:r};t.default=i},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),i=o(r),a=n(9),s=o(a);t.default={local:i.default,sync:s.default}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),i=o(r),a=(0,i.default)("local");t.default=a},function(e,t){"use strict";function n(){}function o(e){e()}function r(e,t){var n={};if("object"===("undefined"==typeof e?"undefined":a(e))){var o=Object.getOwnPropertyNames(e);o.forEach(function(t){n[t]=e[t]})}else n[e]=null;"function"==typeof t&&t(n)}function i(e){var t={};return s.forEach(function(n){"undefined"==typeof chrome?u[n]&&(t[n]=u[n]):chrome.storage[e][n]&&(t[n]=chrome.storage[e][n].bind(chrome.storage[e]))}),t}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=["get","getBytesInUse","set","remove","clear"],u={get:r,set:o,remove:n,clear:n};t.default=i},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(){return"undefined"==typeof chrome||"undefined"==typeof chrome.storage.sync?a.default:(0,u.default)("sync")}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=o(i),s=n(8),u=o(s),c=r();t.default=c},function(e,t){"use strict";function n(e){"undefined"!=typeof chrome?chrome.tabs.captureVisibleTab(null,{format:"png",quality:100},e):safari.application.activeBrowserWindow.activeTab.visibleContentsAsDataURL(e)}function o(e){if("undefined"!=typeof chrome)return chrome.tabs.create(e);var t=safari.application.activeBrowserWindow.openTab();t.url=e.url}function r(e,t){return"undefined"!=typeof chrome?chrome.tabs.sendMessage(e.id,t):e.page.dispatchMessage(t.name,t)}Object.defineProperty(t,"__esModule",{value:!0});var i={captureVisibleTab:n,create:o,sendMessage:r};t.default=i},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(){for(var e=0;e<d.length;e++){var t=d[e],n="Add "+t+" to Dropmark";chrome.contextMenus.create({contexts:[t],id:"context_"+t,title:n,targetUrlPatterns:["*://*/*"]})}}function i(e){d.forEach(function(t){var n=e.userInfo[t];n&&(["audio","link","image","video"].indexOf(t)>=0&&0!==e.userInfo[t].indexOf("http")||e.contextMenu.appendContextMenuItem("context_"+t,"Add "+t+" to Dropmark"))}),e.contextMenu.contextMenuItems.length||e.contextMenu.appendContextMenuItem("context_page","Add page to Dropmark")}function a(e,t){return e.menuItemId=e.command,e.pageUrl=t.url,e.linkUrl=e.userInfo.link,e.selectionText=e.userInfo.selection,e.userInfo.image?(e.srcUrl=e.userInfo.image,e.mediaType="image"):e.userInfo.video?(e.srcUrl=e.userInfo.video,e.mediaType="video"):e.userInfo.audio&&(e.srcUrl=e.userInfo.audio,e.mediaType="audio"),e}function s(e,t){if("undefined"!=typeof safari){if(e.command.indexOf("context_")===-1)return;var n=safari.application.activeBrowserWindow.activeTab;e=a(e,n),t={title:n.title}}var o=e.menuItemId.replace("context_",""),r={content:e.pageUrl,name:t.title,tab_id:t.id,type:o};"link"===o?(r.name=null,0===e.linkUrl.indexOf("http")&&(r.content=e.linkUrl),"image"===e.mediaType&&0===e.srcUrl.indexOf("http")&&(r.thumbnail=e.srcUrl)):"selection"===o?(r.content=e.selectionText,r.link=e.pageUrl,r.type="text"):"image"===o||"video"===o||"audio"===o?(r.content=e.srcUrl,r.link=e.linkUrl?e.linkUrl:e.pageUrl):"page"===o&&(r.type="link"),r.ga_source="Context menu",(0,c.default)(r)}var u=n(2),c=o(u),d=["page","selection","link","image","video","audio"];"undefined"!=typeof chrome?(chrome.contextMenus.onClicked.addListener(s),r()):(safari.application.addEventListener("contextmenu",i,!1),safari.application.addEventListener("command",s,!1))}]);